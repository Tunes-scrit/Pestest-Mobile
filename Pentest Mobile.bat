@echo off
CHCP 65001 >NUL
:inicio
cls
title Pentest Mobile
color 07
echo.
echo                 .`              `.                
echo                  -.  ```..```  .-                 
echo                `-//++++++++++//-`                
echo               ./++/:/++++++++/:/++/.              MENU PENTEST MOBILE
echo              :+++/  .++++++++.  /+++:             
echo             -+++++/:/++++++++/:/+++++:           
echo            `++++++++++++++++++++++++++`           [1] - Iniciar Diretórios 
echo             ``````````````````````````            
echo     `://:` `//////////////////////////. `-:/:.    [2] - Listar / Iniciar Emuladores Criados 
echo     :++++: `++++++++++++++++++++++++++. -++++/    
echo     :++++: `++++++++++++++++++++++++++. -++++/    [3] - Listar / Iniciar Dispositivos Ligados (Emuladores / Físicos)
echo     :++++: `++++++++++++++++++++++++++. -++++/    
echo     :++++: `++++++++++++++++++++++++++. -++++/    [4] - Listar Pacotes / Permissões / Usuários (Emuladores / Físicos)
echo     :++++: `++++++++++++++++++++++++++. -++++/    
echo     :++++: `++++++++++++++++++++++++++. -++++/    [5] - Criar / Assinar e Verificar Certificados
echo     :++++: `++++++++++++++++++++++++++. -++++/    
echo     `://:` `++++++++++++++++++++++++++. `://:.    [6] - Procurar Vulnerabilidades (Aplicações)
echo            `++++++++++++++++++++++++++.           
echo            `++++++++++++++++++++++++++.           [7] - Engenharia Reversa
echo             .:/++++++++++++++++++++//.           
echo                 `/++++.    `+++++`                [8] - Sair
echo                  /++++.    `+++++`                
echo                  /++++.    `+++++`                
echo                  /++++.    `+++++`  {c} TuciraTeam ©            
echo                  .:::-      -:::.      		   
echo.
echo.
choice /C 12345678 /M "Escolha uma Opção"
if  %errorlevel%==1 goto diretorios
if  %errorlevel%==2 goto emulador
if  %errorlevel%==3 goto listdispositivo
if  %errorlevel%==4 goto menupm
if  %errorlevel%==5 goto assinaturacertificado
if  %errorlevel%==6 goto codispositivo
if  %errorlevel%==7 goto jadx
if  %errorlevel%==8 goto exit
:diretorios
cls
color 07
title Menu Diretórios
echo.
echo   MENU INICIAR DIRETÓRIOS (D.)
echo.
echo.
echo   [1] Iniciar D. Emulador / Tools
echo.
echo   [2] Iniciar D. Ubuntu / Platform-Tools
echo.
echo   [3] Iniciar D. Windows / Platform-Tools
echo.
echo   [4] Iniciar D. Tucira-Tools
echo.
echo   [5] SOS
echo.
echo   [6] Ir para o Menu Pentest Mobile
echo.
echo.
choice /C 123456 /M "Escolha uma Opção"
if  %errorlevel%==1 goto caminho
if  %errorlevel%==2 goto ubuntu 
if  %errorlevel%==3 goto windows
if  %errorlevel%==4 goto tuciratools
if  %errorlevel%==5 goto ajuda
if  %errorlevel%==6 goto inicio
:caminho
title Pentest Mobile/Menu Diretórios - Emulador
start "" "C:\Users\cantu\AppData\Local\Android\sdk\tools" "" rem pode utilizar: explorer "C:\Users\cantu\AppData\Local\Android\sdk\tools"
cls
cmd.exe /k cd C:\Users\cantu\AppData\Local\Android\sdk\tools
goto diretorios
:ubuntu
title Pentest Mobile/Menu Diretórios - UPlatform-tools
cls
echo.
echo cd /mnt/c/users/cantu/AppData/local/android/sdk/platform-tools
echo.
ubuntu2004.exe
goto diretorios
:windows
title Pentest Mobile/Menu Diretórios - WPlatform-tools
cls
explorer "C:\Users\cantu\AppData\Local\Android\sdk\platform-tools"
cmd.exe /k cd C:\Users\cantu\AppData\Local\Android\sdk\platform-tools
goto diretorios
:tuciratools
title Pentest Mobile/Menu Diretórios - tucira-tools
cls
explorer "C:\Users\cantu\Desktop\tucira\Pentest-Mobile\tucira-tools"
cmd.exe /k cd C:\Users\cantu\Desktop\tucira\Pentest-Mobile\tucira-tools
goto diretorios
:emulador
cls
color 07
title Menu Listar / Iniciar Emuladores Criados
echo.
echo   MENU LISTAR / INICIAR EMULADORES CRIADOS
echo.
echo.
echo   [1] Listar Emuladores
echo.
echo   [2] Iniciar Emulador
echo.
echo   [3] SOS
echo.
echo   [4] Ir para o Menu Pentest Mobile
echo.
echo.
choice /C 1234 /M "Escolha uma Opção"
if  %errorlevel%==1 goto lista
if  %errorlevel%==2 goto comemulator 
if  %errorlevel%==3 goto ajuda
if  %errorlevel%==4 goto inicio
:lista
title Pentest Mobile/Listar Emuladores Criados
cls
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\sdk\tools\emulator.exe -list-avds>C:\Users\cantu\Desktop\tucira\Temp\listaemuladores.txt
echo Carregar Enter para Visualizar e Imprimir Lista de Emuladores
pause>nul
cls
color 02
echo.
echo Lista de Emuladores Disponiveis a %date%:
findstr /v "C:\*\*\*\*\*" C:\Users\cantu\Desktop\tucira\Temp\listaemuladores.txt>C:\users\cantu\desktop\Lista_de_Emuladores.txt
echo.
del C:\Users\cantu\Desktop\tucira\Temp\listaemuladores.txt
type "C:\users\cantu\desktop\Lista_de_Emuladores.txt"
echo.
echo.
echo Carregue Enter para ser Redirecionado para o Menu Listar / Iniciar Emuladores Criados...
pause>nul
goto emulador
:comemulator
title Pentest Mobile/Iniciar Emulador
cls
echo.
set /p "input=Digite o Emulador Pretendido e Enter>"
color 0C
cmd.exe /k C:\Users\cantu\AppData\Local\Android\sdk\tools\emulator -avd %input%
goto inicio
:listdispositivo
cls
color 07
title Menu 
echo.
echo   MENU LISTAR / INICIAR DISPOSITIVOS LIGADOS
echo.
echo.
echo   [1] Listar Todos os Dispositivos Ligados 
echo.
echo   [2] Iniciar Dispositivo Ligado
echo.
echo   [3] SOS
echo.
echo   [4] Ir para o Menu Pentest Mobile
echo.
echo.
choice /C 1234 /M "Escolha uma Opção"
if  %errorlevel%==1 goto todosdisp
if  %errorlevel%==2 goto iniciardisp
if  %errorlevel%==3 goto ajuda
if  %errorlevel%==4 goto inicio
:todosdisp
title Pentest Mobile/Listar Todos os Dispositivos Ligados
cls
cmd.exe /c C:\Users\cantu\AppData\Local\Android\sdk\platform-tools\adb.exe devices>C:\Users\cantu\Desktop\tucira\Temp\listadispositivos.txt
echo.
echo Carregar Enter para Visualizar e Imprimir Lista de Dispositivos Móveis Ligados
pause>nul
cls
findstr /v "List of devices attached" C:\Users\cantu\Desktop\tucira\Temp\listadispositivos.txt>C:\users\cantu\desktop\Lista_de_Dispositivos.txt
echo.
color 02
echo Lista dos Dispositivos Moveis Ligados (Emuladores e Fisicos):
echo.
del C:\Users\cantu\Desktop\tucira\Temp\listadispositivos.txt
type "C:\users\cantu\desktop\Lista_de_Dispositivos.txt"
echo.
echo Carregue Enter para ser Redirecionado para o Menu Listar / Iniciar Dispositivos Ligados...
pause>nul
goto listdispositivo
:iniciardisp
title Pentest Mobile/Iniciar Dispositivo Ligado
cls
echo.
set /p "inputdisp=Digite o Dispositivo (Virtual / Físico) Pretendido e Enter>"
cmd.exe /k C:\Users\cantu\AppData\Local\Android\sdk\platform-tools\adb.exe -s %inputdisp% shell
goto inicio
:codispositivo
cls
color 07
title Pentest Mobile/Procurar Vulnerabilidades
echo.
echo    ██╗      
echo    ██║       
echo    ██║          
echo    ╚═╝
echo    ██╗           
echo    ╚═╝ ATENÇÃO: ANTES DE INCIAR O TESTE DE VULNERABILIDADE DEVE GARANTIR:
echo.   
echo.
echo    [i] Ter Instalado e Configurado o Programa Docker  
echo.
echo    [i] Ter o Programa Docker Ligado ANTES de Iniciar o Teste de Vulnerabilidade
echo.
echo.   *****************************************************************************
echo.
echo.
echo   [1] Inciar Teste de Vulnerabilidade 1
echo.
echo   [2] Sair para o Menu Pentest Mobile
echo.
echo.
choice /C 12 /M "[R] Escolha uma Opção"
if  %errorlevel%==1 goto iniciaranalise
if  %errorlevel%==2 goto inicioexit

:iniciaranalise
cls
color 07
echo.
echo.                          
echo        /\            _____
echo       /  \          ^| Pode demorar alguns minutos...A Executar...
echo      /    \         ^|
echo     /      \        ^|
echo _/\/        \       ^|
echo              \      ^|
echo               \  /\_^|
echo                \/
echo.
echo.
ping -n 3 localhost >nul
echo.
rem Criar Imagem no Docker
docker pull ilyaglow/qark:latest
cls
echo.
echo.
echo __/\__  _/\
echo       \/   \
echo             \/\    /\___/\________ A Obter Dados... 
echo                \  /                        
echo                 \/
ping -n 3 localhost >nul
rem Remover o Container com o nome Qark
docker rm qark >nul
cls
echo.
echo.
echo /\/\/\
echo       \  /\
echo        \/  \    /\
echo             \  /  \/\  ______/\_  ______^| Aguardar... 
echo              \/      \/         \/
ping -n 3 localhost >nul
echo.
rem Criar um Container com o nome Qark
docker container create -t --name qark ilyaglow/qark:latest >nul
cls
echo.
set /p "inputqark=[R] Digite o Caminho do Ficheiro.APK (exemplo: C:\Users\cantu\Desktop\teste.apk>"
echo.
rem Iniciar o Container
docker start qark >nul
rem faz um delay de 3 segundos
ping -n 3 localhost >nul
rem Criar o Diretorio pentest no container, para salvar os diretorios criados pela aplicação qark
docker exec qark mkdir pentest
rem Copiar o Ficheiro.apk que queremos analisar do pc para a pasta pentest (que criamos acima) que está dentro do container Qark
docker cp %inputqark% qark:/qark/pentest/
echo.
set /p "vaidisto=[R] Digite o Nome do Ficheiro.APK (exemplo: teste.apk)>"
rem Operação para analisar o Ficheiro.apk
cmd.exe /k docker exec -it qark python qarkMain.py -s 1 -p /qark/pentest/%vaidisto% -a 1 -e 0 -r /qark/pentest/
rem Remover o Container com o nome Qark
docker rm qark 
goto inicio
:jadx
title Pentest Mobile/Engenharia Reversa
cls
echo.
call C:\Users\cantu\Desktop\tucira\Atalhos\Engenharia_Reversa-Versão_Gráfica.bat
goto inicio
:menupm
cls
color 07
echo.
echo   MENU GESTOR DE PACOTES - DISPOSITIVO 
echo.
echo.
echo   [1] Listar Usuários
echo.
echo   [2] Listar Todos os Pacotes
echo.
echo   [3] Listar Permissões 
echo.
echo   [4] Mostrar Caminho - Ficheiro APK do Pacote
echo.
echo   [5] Ir para o Menu Pentest Mobile
echo.
echo.
choice /C 12345 /M "[R] Escolha uma Opção"
if  %errorlevel%==1 goto usulist
if  %errorlevel%==2 goto listapacotes
if  %errorlevel%==3 goto permissionall
if  %errorlevel%==4 goto caminhoapkpac
if  %errorlevel%==5 goto inicio
:usulist
cls
color 02
echo.
echo.
set /p "inputdivice=[P] Digite o Nome do Dispositivo Pretendido e Enter>"
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\sdk\platform-tools\adb -s %inputdivice% shell pm list users
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Gestor de Pacotes
pause>nul
goto menupm
:listapacotes
cls
color 02
echo.
echo.
set /p "inputdivice=[P] Digite o Nome do Dispositivo Pretendido e Enter>"
echo.
echo [R] LISTA PACOTES DE SISTEMA:
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\sdk\platform-tools\adb -s %inputdivice% shell pm list packages -s>Lista_de_Pacotes_Sistema.txt
type Lista_de_Pacotes_Sistema.txt
echo.
echo [R] LISTA PACOTES DE TERCEIROS:
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\sdk\platform-tools\adb -s %inputdivice% shell pm list packages -3>Lista_de_Pacotes_Terceiros.txt
type Lista_de_Pacotes_Terceiros.txt
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Gestor de Pacotes
pause>nul
goto menupm
:permissionall
cls
color 07
echo.
echo   MENU - LISTA DE PERMISSÕES
echo.
echo.
echo   [1] Listar Todas as Permissões
echo.
echo   [2] Listar Permissões Importantes 
echo.
echo   [3] Listar Permissões Simples
echo.
echo   [4] SOS
echo.
echo   [5] Ir para o  Menu Gestor de Pacotes 
echo.
echo.
choice /C 12345 /M "[R] Escolha uma Opção"
if  %errorlevel%==1 goto listpermissoes
if  %errorlevel%==2 goto permissoesdanger 
if  %errorlevel%==3 goto listsimplepermissoes
if  %errorlevel%==4 goto ajuda
if  %errorlevel%==5 goto menupm
:listpermissoes
cls
color 02
echo.
set /p "dist012=[P] Digite o Nome do Dispositivo Pretendido e Enter>"
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\Sdk\platform-tools\adb -s %dist012% shell pm list permissions -f -g>Lista_Todas_as_Permissões.txt
type Lista_Todas_as_Permissões.txt
echo.
echo ***********LISTA de TODAS as PERMISSÕES**************
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Lista de Permissões
pause>nul
goto permissionall
:permissoesdanger
cls
color 02
echo.
set /p "dist353=[P] Digite o Nome do Dispositivo Pretendido e Enter>"
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\Sdk\platform-tools\adb -s %dist353% shell pm list permissions -f -g -d>Lista_Permissões_Perigosas.txt
type Lista_Permissões_Perigosas.txt
echo.
echo ***********LISTA de PERMISSÕES INPORTANTES**************
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Lista de Permissões
pause>nul
goto permissionall
:listsimplepermissoes
cls
color 02
echo.
set /p "dist649=[P] Digite o Nome do Dispositivo Pretendido e Enter>"
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\Sdk\platform-tools\adb -s %dist649% shell pm list permissions -u -g>Lista_Permissões_Simples.txt
type Lista_Permissões_Simples.txt
echo.
echo ***********LISTA de PERMISSÕES SIMPLES**************
echo.
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Lista de Permissões
pause>nul
goto permissionall
:caminhoapkpac
cls
color 02
echo.
echo.
set /p "pathdevice=[P] Digite o Nome do Dispositivo Pretendido e Enter>"
echo.
set /p "apkcaminho=[P] Digite o Nome do Pacote e Enter>"
echo.
echo [i] Destino do ficheiro APK do Pacote %apkcaminho% no Dispositivo %pathdevice%:
echo.
cmd.exe /c C:\Users\cantu\AppData\Local\Android\sdk\platform-tools\adb -s %pathdevice% shell pm path %apkcaminho%
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Gestor de Pacotes
pause>nul
goto menupm
:ajuda
title Pentest Mobile/Menu Diretórios - SOS
start "" "C:\Users\cantu\Desktop\tucira\SOS" ""
goto diretorios
:assinaturacertificado
cls
color 07
title Menu Certificado
echo.
echo   MENU CERTIFICADO 
echo.
echo.
echo   [1] Criar Chave
echo.
echo   [2] Assinar Ficheiro APK 
echo.
echo   [3] Verificar Assinatura no Ficheiro APK
echo.
echo   [4] SOS
echo.
echo   [5] Ir para o Menu Pentest Mobile
echo.
echo.
choice /C 12345 /M "Escolha uma Opção"
if  %errorlevel%==1 goto criarchave
if  %errorlevel%==2 goto assinarapp 
if  %errorlevel%==3 goto verassinatura
if  %errorlevel%==4 goto ajuda
if  %errorlevel%==5 goto inicio
:criarchave
cls
echo.
echo    ██╗      
echo    ██║       
echo    ██║       
echo    ╚═╝
echo    ██╗          
echo    ╚═╝ ATENÇÃO: Para a ferramenta funcionar corretamente deve garantir o seguinte:
echo.
echo.
echo [!] 1 - CRIAR uma VARIÁVEL de AMBIENTE no sistema/utilizador para a ferramenta KEYTOOL
echo. 
echo         Obs.: Normalmente encontra-se no diretório: ...\java\jdk-versãoinstalada\bin\)
echo.
echo.
echo.
echo [!] 2 - DIGITAR o solicitado SEM ESPAÇOS, por exemplo: Nome_da_Chave, Local, Palavra-Passe, Diretórios, ...
echo.
echo.
echo [i] Carregue Enter para Continuar ou CTRL+C para Sair
pause>nul
cls
echo. 
echo.
set /p "localferramenta=[P] Digite o Diretório onde Pertende Guardar a Chave (Exemplo - C:\Users\cantu\Desktop\) e Enter>"
echo.
set /p "nomeassinatura=[P] Digite o Nome da Chave (sem espaços)e Enter (Exemplo - chavesemespaços)>"
echo.
set /p "passassinatur=[P] Digite a Palavra-Passe da Chave (com pelo menos 8 carateres) e Enter>"
echo.
set /p "valssinatur=[P] Digite a Validade Pretendida para a Chave (30,60,90,120,..360) e Enter>"
echo.
set /p "deptssina=[P] Digite o Nome do Autor/Departamento que Criou a Chave(pode deixar em branco) e Enter>"
echo.
set /p "localassinat=[P] Digite o Local, Cidade ou País onde a Chave Foi Criada(pode deixar em branco) e Enter>"
echo.
cmd.exe /c keytool -genkey -keystore "%localferramenta%%nomeassinatura%.jks" -storepass %passassinatur% -storetype pkcs12 -alias %nomeassinatura% -keyalg RSA -dname "CN=%nomeassinatura%, OU=%deptssina%, C=%localassinat%" -keypass %passassinatur% -validity %valssinatur%
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Certificado
pause>nul
goto assinaturacertificado
:assinarapp
cls
echo.
echo    ██╗      
echo    ██║       
echo    ██║       
echo    ╚═╝
echo    ██╗          
echo    ╚═╝ ATENÇÃO: Para a ferramenta funcionar corretamente deve garantir o seguinte:
echo.
echo.
echo [!] 1 - CRIAR uma VARIÁVEL de AMBIENTE no sistema/utilizador para a ferramenta JARSIGNER
echo. 
echo         Obs.: Normalmente encontra-se no diretório: ...\java\jdk-versãoinstalada\bin\)
echo.
echo.
echo.
echo [!] 2 - DIGITAR o solicitado SEM ESPAÇOS, por exemplo: Nome_da_Chave, Local, Palavra-Passe, Diretórios, ...
echo.
echo.
echo [i] Carregue Enter para Continuar ou CTRL+C para Sair
pause>nul
cls
echo. 
echo.
set /p "nassin=[P] Digite o Nome da Chave (Exemplo - chavesemespaços)e Enter>"
echo.
set /p "lochave=[P] Digite o Diretório onde encontra-se a Chave (Exemplo - C:\Users\cantu\Desktop\chavesemespaços.jks) e Enter>"
echo.
set /p "passchave=[P] Digite a Palavra-Passe da Chave e Enter>"
echo.
set /p "locapk=[P] Digite o Diretório onde encontra-se o ficheiro.apk (Exemplo - C:\Users\cantu\Desktop\ficheiro.apk) e Enter>"
echo.
goto timeselo
:timeselo
echo.
echo Deseja incluir um timestamp?
echo.
echo.
echo [1] - Sim 
echo. 
echo [2] - Não
echo.
echo.
choice /C 12 /M "[R] Escolha uma Opção"
if  %errorlevel%==1 goto selotempo
if  %errorlevel%==2 goto proseguirassinatura
:selotempo
cmd.exe /c jarsigner -keystore "%lochave%" -storepass %passchave% -storetype pkcs12 -sigalg SHA256withRSA -digestalg SHA-256 -tsa http://timestamp.comodoca.com "%locapk%" %nassin%
goto assinaturacertificado
:proseguirassinatura
cmd.exe /c jarsigner -keystore "%lochave%" -storepass %passchave% -storetype pkcs12 -sigalg SHA256withRSA -digestalg SHA-256 "%locapk%" %nassin%
goto assinaturacertificado
:verassinatura
cls
echo. 
echo.
set /p "caminhoapk=[P] Digite o Local onde encontra-se o Ficheiro.APK e Enter>"
echo.
cmd.exe /c jarsigner -verify -certs -verbose "%caminhoapk%"
echo.
echo [i] Carregue Enter para ser redirecionado para o Menu Certificado
pause>nul
goto assinaturacertificado